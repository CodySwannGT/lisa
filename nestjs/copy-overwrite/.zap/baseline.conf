# OWASP ZAP Baseline Scan Configuration — NestJS GraphQL APIs
# Format: <rule_id> <action> <description>
# Actions: IGNORE (skip rule), WARN (report but don't fail), FAIL (fail on finding)
#
# Tuned for NestJS APIs behind API Gateway/load balancer in production.
# Transport-level headers are enforced at infrastructure layer.

# CSP header — API responses don't serve HTML; CSP is a browser concern
10038	WARN	(Content Security Policy (CSP) Header Not Set)

# X-Content-Type-Options — should be set but is infrastructure-level
10021	WARN	(X-Content-Type-Options Header Missing)

# Strict-Transport-Security — enforced at API Gateway/load balancer
10035	WARN	(Strict-Transport-Security Header Not Set)

# X-Frame-Options — API responses are not rendered in browsers
10020	IGNORE	(X-Frame-Options Header Not Set)

# Permissions-Policy — not applicable to API responses
10063	IGNORE	(Permissions Policy Header Not Set)

# Server header disclosure — NestJS/Express may leak version info;
# should be suppressed in production via Helmet middleware
10036	WARN	(Server Leaks Version Information via "Server" HTTP Response Header Field)

# Cookie flags — GraphQL APIs may use session cookies for auth
10010	FAIL	(Cookie No HttpOnly Flag)
10011	FAIL	(Cookie Without Secure Flag)
10054	WARN	(Cookie without SameSite Attribute)

# Information disclosure in URL — GraphQL uses POST body, not URL params
10024	IGNORE	(Information Disclosure - Sensitive Information in URL)

# Cross-domain JavaScript source — not applicable to API
10017	IGNORE	(Cross-Domain JavaScript Source File Inclusion)

# Application error disclosure — NestJS should not leak stack traces
10023	FAIL	(Information Disclosure - Debug Error Messages)
